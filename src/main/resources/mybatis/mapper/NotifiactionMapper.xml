<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.flab.fkream.notification.NotificationMapper">

  <resultMap id="notificationResultMap" type="com.flab.fkream.notification.Notification">
    <id property="id" column="id"/>
    <result property="userId" column="user_id"/>
    <result property="itemId" column="item_id"/>
    <result property="dealId" column="deal_id"/>
    <result property="title" column="title"/>
    <result property="context" column="context"/>
    <result property="notificationType" column="notification_type"/>
    <result property="createdAt" column="created_at"/>
  </resultMap>

  <insert id="save" useGeneratedKeys="true" keyProperty="id"
    parameterType="com.flab.fkream.notification.Notification">
    insert into notification (user_id, item_id, deal_id, title, context, notification_type,
                              CREATED_AT)
    values (#{userId}, #{itemId}, #{dealId}, #{title}, #{context}, #{notificationType}, #{createdAt})
  </insert>

  <insert id="saveAll" parameterType="com.flab.fkream.notification.Notification">
    insert into notification (user_id, item_id, deal_id, title, context, notification_type,
    CREATED_AT)
    values
    <foreach collection="notifications" item="notification" separator=",">
      (#{notification.userId}, #{notification.itemId}, #{notification.dealId}, #{notification.title},
      #{notification.context} , #{notification.notificationType}, #{notification.createdAt})
    </foreach>
  </insert>

  <select id="findByUserId" resultMap="notificationResultMap">
    select *
    from notification nf
    where nf.user_id = #{userId}
  </select>

  <select id="findById" resultMap="notificationResultMap">
    select *
    from notification nf
    where nf.id = #{id}
  </select>

  <delete id="delete">
    delete
    from notification nf
    where nf.id = #{id}
  </delete>
</mapper>